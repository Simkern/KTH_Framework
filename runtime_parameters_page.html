<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>KTH framework for Nek5000 toolboxes; testing version: Runtime parameters for KTH framework.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KTH framework for Nek5000 toolboxes; testing version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('runtime_parameters_page.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Runtime parameters for KTH framework. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="rparam_file"></a>
Runtime parameter file.</h1>
<p>An important issue for our framework is organised structure of runtime parameters that would allow for simple modiffication of parameter list without introducing conflicts between different code parts. As old <em>setup.rea</em> file does not provide sufficent flexibility, all tool developers are obligated to use new <em>setup.par</em> file instead, as it organises runtime parameters by sections and in addition to 20 user parameters in <em></em>[GENERAl] section allows to introduce user defined sections. Every section starting with underscore is treated as user section and its consistency is not checked by Nek5000 core code. Following examples shows two native Nek5000 sections and three user section correspondings to the modules <a class="el" href="group__chkpoint.html">chkpoint</a>, <a class="el" href="group__tstepper.html">tstepper</a> and <a class="el" href="group__arnoldi__arpack.html">arnoldi_arpack</a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="preprocessor"># nek parameter file</span></div><div class="line"><span class="preprocessor">#</span></div><div class="line">[GENERAL] </div><div class="line"><span class="preprocessor">#startFrom = restart.fld </span></div><div class="line">stopAt = numSteps #endTime</div><div class="line">endTime = 1.0</div><div class="line">numSteps = 500</div><div class="line"></div><div class="line">[VELOCITY]</div><div class="line">residualTol = 1e-12</div><div class="line">residualProj = no</div><div class="line"><span class="preprocessor">#density = 1</span></div><div class="line"></div><div class="line">[_CHPOINT]</div><div class="line">chkpInterval = 25</div><div class="line">readchkpt = yes</div><div class="line">chkpFnumber = 2</div><div class="line">WallTime = 02:05</div><div class="line"> </div><div class="line">[_TIME_STEPPER]</div><div class="line">mode = 1</div><div class="line">steps =  40</div><div class="line">maxCycles = 200</div><div class="line">tol =  1.0E-06</div><div class="line">ifuzawa = <a class="code" href="gs__test_8c.html#a634f2e2245ac87de466e2810dee4f841">T</a></div><div class="line"></div><div class="line">[_ARPACK]</div><div class="line">arnkrylov = 100</div><div class="line">arnegv = 10</div><div class="line">arnistart = 1</div><div class="line">arnistop = 2</div></div><!-- fragment --><h1><a class="anchor" id="rparam_module"></a>
Module's runtime parameters.</h1>
<p>We utilize user defined sections in <em>setup.par</em> to set values of runtime parametes defined in different modules. To simplify interaction between different tools the <a class="el" href="group__frame.html">frame</a> module provides dynamical database of all available in the framework runtime parameters. To achieve this we introduce module registration phase and split if from module intialistation. The first step is initialisation of the framework itself by callilng <a class="el" href="group__frame.html#ga3b2fa5ca96c4d901949ed15b9e1e459c">frame_start</a>. Next all the tools have to register themselves, their runtime parameters (providing name, type, description and default values) and timers. At this point <a class="el" href="group__frame.html#gaee3c3ea1286133a48657b699ae884a70">frame_rparam</a> can get values of registerd runtime parametars stored <em>setup.par</em> and distribute them among processors. Finally all the modules can take back updated values of the runtime parameters and start module initialisation. Following example shows the way to initialise framework na d checkpointing module in <em>userchk:</em> </p><div class="fragment"><div class="line"><span class="keyword">      subroutine </span>userchk</div><div class="line">      include <span class="stringliteral">&#39;TSTEP&#39;</span></div><div class="line">      </div><div class="line">      <span class="keywordflow">if</span> (istep.eq.0) <span class="keywordflow">then</span></div><div class="line"><span class="comment">!     start framework</span></div><div class="line">         <span class="keyword">call </span><a class="code" href="group__frame.html#ga3b2fa5ca96c4d901949ed15b9e1e459c">frame_start</a></div><div class="line"><span class="comment">!     register modules</span></div><div class="line">         <span class="keyword">call </span><a class="code" href="group__chkpoint.html#gab4a17862a5f644ef26e2538240fc3ae8">chkpt_register</a></div><div class="line"><span class="comment">!     get runtime parameters</span></div><div class="line">         <span class="keyword">call </span><a class="code" href="group__frame.html#gaee3c3ea1286133a48657b699ae884a70">frame_rparam</a></div><div class="line"><span class="comment">!     initialise modules</span></div><div class="line">         <span class="keyword">call </span><a class="code" href="group__chkpoint.html#ga1523ccf52ac13164ba8fcb08a7d0da33">chkpt_init</a></div><div class="line"></div><div class="line"><span class="keywordflow">      endif</span></div><div class="line"></div><div class="line"><span class="comment">!     save/load files for full-restart</span></div><div class="line">      <span class="keyword">call </span><a class="code" href="group__chkpoint.html#ga2d682999600b8303ea7c4850cb54c9ca">chkpt_main</a></div><div class="line"></div><div class="line"><span class="comment">!     finalise framework</span></div><div class="line">      <span class="keywordflow">if</span> (istep.ge.nsteps.or.lastep.eq.1) <span class="keywordflow">then</span></div><div class="line">         <span class="keyword">call </span><a class="code" href="group__frame.html#ga81cd9de9df55590aae9e54090dd1a3ce">frame_end</a></div><div class="line"><span class="keywordflow">      endif</span></div><div class="line"></div><div class="line">      <span class="keywordflow">return</span></div><div class="line"><span class="keyword">      end</span></div></div><!-- fragment --><p>Each tool has to provide routines for registration and intialisation of the given module. <a class="el" href="group__chkpoint.html#gab4a17862a5f644ef26e2538240fc3ae8">chkpt_register</a> and <a class="el" href="group__chkpoint.html#ga1523ccf52ac13164ba8fcb08a7d0da33">chkpt_init</a> are good example of them.</p>
<p>Dependencies between different modules can be expressed as a tree structure, which we would like to follow in our databese. That is why each module during registration has to specify its parent, which can be its real parent module (for submodules) or NEK5000 module (the first module registered by frame). In a similar way we specify parents for timers.</p>
<p>The list of all defined parameters, their dafault values and dependency between different modules are described in following pages:</p><ul>
<li><a class="el" href="parameter_list_page.html">List of runtime parameters provided by modules.</a></li>
<li><a class="el" href="parameter_required_page.html">List of runtime parameters required by modules.</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Oct 17 2017 13:41:03 for KTH framework for Nek5000 toolboxes; testing version by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
