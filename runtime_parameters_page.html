<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>KTH framework for Nek5000 toolboxes; testing version: Runtime parameters for KTH framework.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KTH framework for Nek5000 toolboxes; testing version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('runtime_parameters_page.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Runtime parameters for KTH framework. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="rparam_file"></a>
Runtime parameter file.</h1>
<p>An important issue for our framework is organised structure of runtime parameters that would allow for simple modiffication of parameter list without introducing conflicts between different code parts. As old <em>setup.rea</em> file does not provide sufficent flexibility, all tool developers are obligated to use new <em>setup.par</em> file instead, as it organises runtime parameters by sections and in addition to 20 user parameters in <em></em>[GENERAl] section allows to introduce user defined sections. Every section starting with underscore is treated as user section and its consistency is not checked by Nek5000 core code. Following examples shows two native Nek5000 sections and three user section correspondings to the modules <a class="el" href="group__chkpoint.html">chkpoint</a>, <a class="el" href="group__tstepper.html">tstepper</a> and <a class="el" href="group__arnoldi__arpack.html">arnoldi_arpack</a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="preprocessor"># nek parameter file</span></div><div class="line"><span class="preprocessor">#</span></div><div class="line">[GENERAL] </div><div class="line"><span class="preprocessor">#startFrom = restart.fld </span></div><div class="line">stopAt = numSteps #endTime</div><div class="line">endTime = 1.0</div><div class="line">numSteps = 500</div><div class="line"></div><div class="line">[VELOCITY]</div><div class="line">residualTol = 1e-12</div><div class="line">residualProj = no</div><div class="line"><span class="preprocessor">#density = 1</span></div><div class="line"></div><div class="line">[_CHPOINT]</div><div class="line">chkptstep = 10</div><div class="line">ifchkptrst = no</div><div class="line"> </div><div class="line">[_TSTEPPER]</div><div class="line">tstmode = 1</div><div class="line">tststep = 40</div><div class="line">tstcmax = 200</div><div class="line">tsttol = 1.0e-06</div><div class="line">tstifuzawa = yes</div><div class="line"></div><div class="line">[_ARPACK]</div><div class="line">arnkrylov = 100</div><div class="line">arnegv = 10</div><div class="line">arnistart = 1</div><div class="line">arnistop = 2</div></div><!-- fragment --><h1><a class="anchor" id="rparam_module"></a>
Module's runtime parameters.</h1>
<p>We use user defined sections to introduce runtime parametes defined in modules. Every module introducing new set of runtime parameters should manage their initialisation independently providing adequate initialisation routines, that could be called within <em>userchk:</em> </p><div class="fragment"><div class="line"><span class="keyword">      subroutine </span>userchk</div><div class="line">      include <span class="stringliteral">&#39;TSTEP&#39;</span></div><div class="line">      </div><div class="line">      <span class="keywordflow">if</span> (istep.eq.0) <span class="keywordflow">then</span></div><div class="line"><span class="comment">!     initialise runtime parameters</span></div><div class="line">         <span class="keyword">call </span><a class="code" href="group__chkpoint.html#ga295cd675834c01792013599f86bbc29c">chkpt_param_get</a></div><div class="line">         <span class="keyword">call </span>tstpr_param_get</div><div class="line"><span class="keywordflow">      endif</span></div><div class="line">      </div><div class="line"><span class="comment">!     main checkpoint interface</span></div><div class="line">      <span class="keyword">call </span>checkpoint_main</div><div class="line"><span class="comment">!     main time stepper interface</span></div><div class="line">      <span class="keyword">call </span><a class="code" href="group__tstepper.html#ga807771faae88aaf61d75b90d639b4ba6">tstepper_main</a></div><div class="line"></div><div class="line">      <span class="keywordflow">return</span></div><div class="line"><span class="keyword">      end</span></div></div><!-- fragment --><p>Each parameter reader should contain following sections:</p><ul>
<li>initialisation with default values</li>
<li>check Nek5000 dictionary for module's runtime parameter consistency</li>
<li>reading values from Nek5000 dictionary</li>
<li>broadcasting data</li>
<li>call to submodul's parameter reader</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>Current version of runtime parameter code does not provide enough flexibility to check if the user section names are properly spelled. It does not output default parameter value either. It could be important for user modules, as different modules irrespective of their dependencies could be managed by different users.</dd></dl>
<p>To avoid conflicts between different modules the runtime parameter and module initialisation are separated. It is because the Nek5000 dictionary (<em>setup.par</em> file) can list only the parameters that differ from their default values, and those are specified in a code of a given module only. That is why at the module initialisation step we use variables defined in include files instead of the dictionary. In case of Nek5000 runtime parameters we use variables defined in <em>INPUT</em> include file, e.g. <em>param</em> array.</p>
<p>The list of all defined parameters and dependency between different modules are described in following pages:</p><ul>
<li><a class="el" href="parameter_list_page.html">List of runtime parameters provided by modules.</a></li>
<li><a class="el" href="parameter_required_page.html">List of runtime parameters required by modules.</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Sep 8 2017 12:37:30 for KTH framework for Nek5000 toolboxes; testing version by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
